# -*- coding: utf-8 -*-
"""–ó–∞–Ω—è—Ç–∏–µ 3.  Pandas

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Ckioj42mdQwIitDleO914dMCc2SHHvzG

"""

from google.colab import drive
drive.mount('/content/drive')

"""

---




 -  <a href="http://pandas.pydata.org/">Pandas</a> - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–Ω–æ–π –ø—Ä–∏—Ä–æ–¥—ã - –º–∞—Ç—Ä–∏—á–Ω—ã—Ö, –ø–∞–Ω–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤. –ü—Ä–µ—Ç–µ–Ω–¥—É–µ—Ç –Ω–∞ –∑–≤–∞–Ω–∏–µ —Å–∞–º–æ–≥–æ –º–æ—â–Ω–æ–≥–æ –∏ –≥–∏–±–∫–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º."""

import pandas as pd

"""–í –ø–∞–Ω–¥–∞—Å –µ—Å—Ç—å –¥–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:
- Series: –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ —Å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏ (—á–∞—â–µ –≤—Å–µ–≥–æ, –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞)
- DataFrame: –¥–≤—É—Ö–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤, –∏–º–µ–µ—Ç —Ç–∞–±–ª–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –ª–µ–≥–∫–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º, –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤ —Å–µ–±–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤

–û–±–∞ —Ç–∏–ø–∞ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ —Å–∞–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- pandas.Series(data=None, index=None, dtype=None)
- pandas.DataFrame(data=None, index=None, columns=None, dtype=None)

- **data** - –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –∑–∞–ø–∏—Å–∞—Ç—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- **index** - –∏–Ω–¥–µ–∫—Å—ã —Å—Ç—Ä–æ–∫
- **columns** - –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
- **dtype** - —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö

–ö—Ä–æ–º–µ data, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

<body>
    <div class="container">
        <div>
            <h2>Series</h2>
            <table>
                <tr>
                    <th></th>
                    <th>–ú–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã</th>
                </tr>
                <tr>
                    <td>0</td>
                    <td>Toyota</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Honda</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Ford</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Chevrolet</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Volkswagen</td>
                </tr>
            </table>
        </div>
        <div>
            <h2>DataFrame</h2>
            <table>
                <tr>
                    <th></th>
                    <th>–º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã</th>
                    <th>–≥–æ–¥ –≤—ã–ø—É—Å–∫–∞</th>
                    <th>—Ü–µ–Ω–∞</th>
                </tr>
                <tr>
                    <td>0</td>
                    <td>Toyota</td>
                    <td>2022</td>
                    <td>25120.60</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Honda</td>
                    <td>2021</td>
                    <td>22536.90</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Ford</td>
                    <td>2020</td>
                    <td>15305.10</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Chevrolet</td>
                    <td>2022</td>
                    <td>21733.50</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Volkswagen</td>
                    <td>2021</td>
                    <td>45345.88</td>
                </tr>
            </table>
        </div>
    </div>
</body>

## ***–°–æ–∑–¥–∞–Ω–∏–µ Series (–æ–¥–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞)***

---

|  | –ú–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã |
|-------|--------------|
|   0   |    Toyota    |
|   1   |     Honda    |
|   2   |     Ford     |
|   3   |  Chevrolet   |
|   4   |  Volkswagen  |
"""

car_prices = pd.Series({
    'Toyota': 25000,
    'Honda': 22000,
    'Ford': 23000,
    'Chevrolet': 21000,
    'Volkswagen': 27000
})

car_prices2 = pd.Series({
    1:'Toyota',
    2:'Honda',
    3:'Ford',
    4:'Chevrolet',
    5:'Volkswagen',
})


# –í—ã–≤–æ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É Series
print(car_prices, end='\n\n')
print(car_prices2)

car_prices





"""## ***–°–æ–∑–¥–∞–Ω–∏–µ DataFrame (–¢–∞–±–ª–∏—Ü—ã)***

---
|  | –º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã  | –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞ |    —Ü–µ–Ω–∞  |
|----|-------------|-------------|----------|
| 0 |    Toyota    |    2022     |  25 000  |
| 1 |     Honda    |    2021     |  22 000  |
| 2 |     Ford     |    2020     |  15 000  |
| 3 |  Chevrolet   |    2022     |  21 000  |
| 4 |  Volkswagen  |    2021     |  45 000  |

>**1 –í–∞—Ä–∏–∞–Ω—Ç**
"""

# –°–æ–∑–¥–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É DataFrame
data = {
    '–º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã': ['Toyota', 'Honda', 'Ford', 'Chevrolet', 'Volkswagen'],
    '–≥–æ–¥ –≤—ã–ø—É—Å–∫–∞': [2022, 2021, 2020, 2022, 2021],
    '—Ü–µ–Ω–∞': [25120.60, 22536.90, 15305.10, 21733.50, 45345.88]
}

df = pd.DataFrame(data)

display(df)
display(df)



df



"""#### **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**


---



---



- object - —Å—Ç—Ä–æ–∫–æ–≤—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–º–µ—à–∞–Ω–Ω—ã–π —Ç–µ—Å–∫—Ç/—á–∏—Å–ª–æ–≤
- int64 - —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π —Ç–∏–ø, –∑–∞–Ω–∏–º–∞–µ—Ç 64 –±–∏—Ç–∞
- float64 - —Ç–∏–ø —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞), –∑–∞–Ω–∏–º–∞–µ—Ç 64 –±–∏—Ç–∞
- bool - –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π True/False
- datetime64 - —Ç–∏–ø –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏
- timedelta64 - —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏
- category - —Ç–∏–ø –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π)

---


"""

display(df)
print(df.dtypes)
df.dtypes

"""> **2 –í–∞—Ä–∏–∞–Ω—Ç**"""

columns = ['–º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã', '–≥–æ–¥ –≤—ã–ø—É—Å–∫–∞', '—Ü–µ–Ω–∞']

data = [['Toyota',         '2022',        '25000'],
        ['Honda',          '2021',        '22000'],
        ['Ford',           '2020',        '23000'],
        ['Chevrolet',      '2022',        '21000'],
        ['Volkswagen',     '2021',        '27000']]

df2 = pd.DataFrame(data, columns=columns)

display(df2)

"""> –ó–∞–¥–∞–¥–∏–º –∏–Ω–¥–µ–∫—Å—ã"""

columns = ['–º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã', '–≥–æ–¥ –≤—ã–ø—É—Å–∫–∞', '—Ü–µ–Ω–∞']

data = [['Toyota', '2022', '25000'],
        ['Honda', '2021', '22000'],
        ['Ford', '2020', '23000'],
        ['Chevrolet', '2022', '21000'],
        ['Volkswagen', '2021', '27000']]

index = [100, 200, 300, 400, 500] # –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ !!!

df2 = pd.DataFrame(data=data, index=index, columns=columns, dtype=object)

# –í—ã–≤–æ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É
display(df2)
print(df2.dtypes)

"""> **3 –í–∞—Ä–∏–∞–Ω—Ç**"""

text = '''
      –º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã, –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞, —Ü–µ–Ω–∞
      Toyota, 2022, 35 000
      Honda, 1987, 1 500
      Ford, 2005, 6 000
      Volkswagen, 2023, 40000
'''.strip()

with open('car.csv', 'w') as f:
  f.write(text)


df2 = pd.read_csv('/content/car.csv')

display(df2)

"""#### `delimiter=','` (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å)"""

print(1,2, sep=' ')

text = '''
      –º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã; –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞; —Ü–µ–Ω–∞
      Toyota; 2022; 35 000
      Honda; 1987; 1 500
      Ford; 2005; 6 000
      Volkswagen; 2023; 40000
'''.strip()

with open('car.csv', 'w') as f:
  f.write(text)


df2 = pd.read_csv('car.csv')
df3 = pd.read_csv('car.csv', delimiter=';')

display(df2)
print(end='\n\n')
display(df3)

display(df3)

"""#### `encoding` (–∫–æ–¥–∏—Ä–æ–≤–∫–∞)"""

text = '''
      –º–∞—Ä–∫–∞ –º–∞—à–∏–Ω—ã; –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞; —Ü–µ–Ω–∞
      Toyota; 2022; 35 000
      Honda; 1987; 1 500
      Ford; 2005; 6 000
      Volkswagen; 2023; 40000
'''.strip()

with open('car.csv', 'w', encoding='cp1251') as f:
  f.write(text)


df4 = pd.read_csv('car.csv', delimiter=';', encoding='cp1251')

display(df4)

"""## ***–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã***
–ë–∞–∑–∞ –≤–∏–Ω = https://drive.google.com/file/d/1I0IrgrlR-Phv1sQZHOfr1ld866yMTahE/view

#### 1 —Å–ø–æ—Å–æ–± –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
"""

import gdown

path_download = 'https://drive.google.com/uc?id=1I0IrgrlR-Phv1sQZHOfr1ld866yMTahE'

gdown.download(path_download, None, quiet=False)

# Commented out IPython magic to ensure Python compatibility.
# %cat wine_base.csv

#*** /content/wine_base.csv
## df = pd.read_csv('/content/wine_base.csv')
df.head(12)

"""#### 2 —Å–ø–æ—Å–æ–± –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—Ü—ã"""

path_download

df2 = pd.read_csv(path_download)
df2

"""–§—É–Ω–∫—Ü–∏–∏ –≤–∏–¥–∞ `pd.read_—Ñ–æ—Ä–º–∞—Ç()` –∏ `pd.to_—Ñ–æ—Ä–º–∞—Ç()`
—Å—á–∏—Ç—ã–≤–∞—é—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

C—á–∏—Ç–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ **csv** (***comma separated value/–∑–Ω–∞—á–µ–Ω–∏—è, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ –∑–∞–ø—è—Ç—ã–º–∏***) —Ñ—É–Ω–∫—Ü–∏–µ–π <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html#pandas.read_csv"> `pd.read_csv()`</a>.

–°–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤:
 - **filepath_or_buffer** - —Ç–µ–∫—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º (–∞–¥—Ä–µ—Å–æ–º) —Ñ–∞–π–ª–∞;
 - **sep** - —Å–∏–º–≤–æ–ª, –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–¥–µ–ª–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –≤ —Ñ–∞–π–ª–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ",");
 - **header** - –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤ —Ñ–∞–π–ª–µ —É–∫–∞–∑–∞–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ (**None**, –µ—Å–ª–∏ –Ω–µ—Ç);
 - **names** - —Å–ø–∏—Å–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Å—Ç–æ–ª–±—Ü–æ–≤;
 - **index_col** - —Å—Ç–æ–ª–±–µ—Ü, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞–¥–æ –≤–∑—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
 - **usecols** - —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞
"""

df = pd.read_csv('/content/wine_base.csv', index_col=0)
df

df.to_

pd.read_? # —á–∏—Ç–∞–µ–º
df.to_? # —Å–æ—Ö—Ä–∞–Ω—è–µ–º

"""### ***–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤*** (parameter = names)"""

new_names = ['—Å—Ç—Ä–∞–Ω–∞', '–æ–ø–∏—Å–∞–Ω–∏–µ', '–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', '–±–∞–ª–ª—ã', '—Ü–µ–Ω–∞', '–ø—Ä–æ–≤–∏–Ω—Ü–∏—è', '—Ä–µ–≥–∏–æ–Ω_1', '—Ä–µ–≥–∏–æ–Ω_2', '—Å–æ—Ä—Ç', '–≤–∏–Ω–æ–¥–µ–ª—å–Ω—è']

df_rus = pd.read_csv('wine_base.csv', names=new_names, index_col=0, header=1)
df_rus.head()

"""### ***–í—ã–±–∏—Ä–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏*** (parameter = usecols)"""

data3 = pd.read_csv('wine_base.csv', usecols=['country', 'points', 'price'])
data3.tail(3)

"""### ***–ó–∞–¥–∞—Ç—å –∫–æ–ª-–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Å—Ç—Ä–æ–∫ –ø—Ä–∏ –≤—ã–≤–æ–¥–µ***"""

MaxDF = pd.read_csv('/content/sample_data/mnist_test.csv')
MaxDF

MaxDF[:100]

pd.set_option("display.max_columns", 100)
pd.set_option("display.max_rows", 500)

MaxDF = pd.read_csv('/content/sample_data/mnist_test.csv')
MaxDF

MaxDF[:500]

"""## ***–£–¥–∞–ª–µ–Ω–∏–µ***

---

–í Pandas –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ DataFrame:

***–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏:***
- data.drop(index) - —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏
- data.drop(labels, axis=0) - —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ

***–£–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã:***
- data.drop(columns) - —É–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
- data.drop(labels, axis=1) - —É–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

***–£–¥–∞–ª–∏—Ç—å duplicates:***
- data.drop_duplicates() - —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Ç—Ä–æ–∫

***–£–¥–∞–ª–∏—Ç—å NaN:***
- data.dropna() - —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏/—Å—Ç–æ–ª–±—Ü—ã —Å NaN –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

```python
# –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ —Å NaN –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ 'A'
df = df.dropna(subset=['A'])

# –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫—É —Å –∏–Ω–¥–µ–∫—Å–æ–º 3 (–≥–¥–µ –µ—Å—Ç—å NaN)
df = df.dropna(axis=0, index=[3])
```
---
"""

df_rus.head(1)

# –£–¥–∞–ª–∏–º 2 —Å—Ç–æ–ª–±—Ü–∞
df_rus.drop(columns=['–æ–ø–∏—Å–∞–Ω–∏–µ', '–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'], inplace=True)

df_rus.head(2)

# –£–¥–∞–ª–∏–º 1 —Å—Ç—Ä–æ–∫—É
df_rus.drop(2, inplace=True)

df_rus.head(2)

"""## ***–í—Å—Ç–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ***

---

---


***–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:***

- `df.loc[index] = [values]` - –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É
- `df.append(other_df)` - –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–≤–∞ DataFrame

***–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü:***

- `df[column_name] = [values]` - –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü –ø–æ –∏–º–µ–Ω–∏
- `df.insert(loc, column, values)` - –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü –ø–æ –∏–Ω–¥–µ–∫—Å—É

***–û–±–Ω–æ–≤–∏—Ç—å —è—á–µ–π–∫–∏:***

- `df.loc[row, column]` = value - –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–æ–∫–µ/—Å—Ç–æ–ª–±—Ü—É
- `df.fillna(values)` - –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —è—á–µ–π–∫

---



---

### ***–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Å—Ç—Ä–æ–∫***
"""

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å—Ç–æ–ª–±—Ü–æ–≤
columns = ['A', 'H', 'T', 'P']

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —è—á–µ–µ–∫
values = [[1, 2, 3, 4],
          [5, 6, 7, 8],
          [9, 10, 11, 12],
          [13, 14, 15, 16]]

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω
df = pd.DataFrame(values, columns=columns)
df

"""#### –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü"""

df['B'] = [1,1,1,1]
df

df.loc[:, 'B'] = [2, 2, 2, 2]
df

"""#### –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –∫ —Å—Ç–æ–ª–±—Ü—É –≤—ã—à–µ"""

df.loc[6] = [0,0,0,0,0]
df

"""#### –û–±–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ"""

df.iloc[0, 1] = 200
df

df.loc[1, 'P'] = 99
df

"""### –£–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã"""

df = df.drop(columns=['B'])
df

"""### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ø–∏–∏"""

data_backup = df.copy()

"""### –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è 2 —Ç–∞–±–ª–∏—Ü"""

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å—Ç–æ–ª–±—Ü–æ–≤
columns = ['t', 'G', 'C']

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —è—á–µ–µ–∫
values = [[10, 20, 30],
          [50, 60, 70],
          [90, 100, 110],
          [130, 140, 150],
          [170, 180, 190]]

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω
df_2 = pd.DataFrame(values, columns=columns)
display(df_2)
df_2.shape

df_2.shape



NEW_table = pd.concat([df, df_2], axis=1)
NEW_table

"""### ***–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞***

---

- **sort_values(axis=0)** —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ —Å—Ç—Ä–æ–∫–∞–º (–∏–Ω–¥–µ–∫—Å–∞–º –æ—Å–∏ 0**) >> default=0**
- **sort_values(axis=1)** —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º (–∏–Ω–¥–µ–∫—Å–∞–º –æ—Å–∏ 1)

#### –ü–æ —Å—Ç–æ–ª–±—Ü—É
"""

df = df.sort_values('H', ascending=True) # ascending=False -> –ü–æ —É–±—ã–≤–∞–Ω–∏—é
df

"""#### –°–±—Ä–æ—Å–∏—Ç—å –∏–Ω–¥–µ–∫—Å"""

df.index = [0,1,2,4]
df

df = df.reset_index(drop = True)
df

"""#### –ü–æ —Å—Ç—Ä–æ–∫–µ"""

df = df.sort_values(by=0, axis=1, ascending=False) # by=4, axis=1 —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏, ascending=True –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
df

df = df.sort_values(by='P', axis=0, ascending=True) # by=4, axis=1 —ç—Ç–æ —Å—Ç–æ–ª–±—Ü—ã, ascending=True –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
df

"""#### –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å—Ç–æ–ª–±—Ü–æ–≤"""

aa = NEW_table[['A','H','C','t', 'G', 'P', 'T']]
aa

"""### –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
"""

df.to_csv('new_salen_train.csv', index=False)

""">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ Google –¥–∏—Å–∫"""

df.to_csv('/content/drive/My Drive/–ë–∞–∑—ã/hh_parsed.csv', sep=';', encoding='cp1251')

"""##  ***–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö***

---

"""

df_rus

"""–ú–µ—Ç–æ–¥ .`shape` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤"""

df_rus.shape

"""–ú–µ—Ç–æ–¥ .size –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:"""

df_rus.size

"""–ò–Ω–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —è—á–µ–π–∫–∞—Ö —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ–ø—É—â–µ–Ω—ã. –≠—Ç–æ —Å–ª—É—á–∞–µ—Ç—Å—è –ø–æ —Ä–∞–∑–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º: –≤–æ–∑–º–æ–∂–Ω–æ, –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –ø—Ä–æ—Å—Ç–æ –Ω–µ –±—ã–ª–æ, –∞ –≤–æ–∑–º–æ–∂–Ω–æ, —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–æ–ª–Ω—è–ª —Ç–∞–±–ª–∏—Ü—É, —Å–ª—É—á–∞–π–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏–ª —è—á–µ–π–∫—É.

–ú–µ—Ç–æ–¥ `.count()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ *–Ω–µ–ø—É—Å—Ç—ã—Ö* –∑–∞–ø–∏—Å–µ–π –≤ –∫–∞–∂–¥–æ–º —Å—Ç–æ–ª–±—Ü–µ:

> –î–æ–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤
"""

df_rus.count()

print(df.shape, end='\n\n')

df_rus.isna().sum() # / df_rus.shape[0]

# @title –ì—Ä–∞—Ñ–∏–∫ data.count
Data = df_rus # @param {type:"raw"}
import matplotlib.pyplot as plt
import seaborn as sns
sns.set_style('darkgrid')

plt.figure(figsize=(14,3))
counts = Data.count()
ax = counts.plot.bar()
ax.set_xlabel('–°—Ç–æ–ª–±—Ü—ã', c='r')
ax.set_ylabel('–ö–æ–ª-–≤–æ –∑–∞–ø–∏—Å–µ–π', c='b')
ax.set_title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—É—Å—Ç—ã—Ö –∑–∞–ø–∏—Å–µ–π –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º', c='gray')


plt.show()

"""–ò—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ .head(), –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–µ—Ç–æ–¥ .count() —Ç–æ–ª—å–∫–æ –∫ –ø–µ—Ä–≤—ã–º —Å—Ç–∞ —Å—Ç—Ä–æ–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã:"""

df_rus.head(100).count() # 0 - 100

"""### ***–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π***

–ú–µ—Ç–æ–¥ `.isna()` –≤—ã–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞, —á—Ç–æ –∏ –∏—Å—Ö–æ–¥–Ω–∞—è, —Ç–æ–ª—å–∫–æ –∑–∞–º–µ–Ω—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ —è—á–µ–π–∫–∞—Ö –Ω–∞ **True** –∏–ª–∏ **False**.
- **True** - –µ—Å–ª–∏ —è—á–µ–π–∫–∞ *–ø—É—Å—Ç–∞*
- **False** - –µ—Å–ª–∏ —è—á–µ–π–∫–∞ *–∑–∞–ø–æ–ª–Ω–µ–Ω–∞*
"""

df_rus.isna().sum()

"""#### *–í –æ—Ç–¥–µ–ª—å–Ω–æ–º –≤–∑—è—Ç–æ–º —Å—Ç–æ–±—Ü–µ*"""

df_rus['—Ü–µ–Ω–∞'].fillna('–ë–µ—Å–ø–ª–∞—Ç–Ω–æ !', inplace=True)

# df_rus['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].fillna('–ü–æ—Ä—Ç–≤–µ–π–Ω', inplace=True)

df_rus.count()

"""#### *–í–æ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü–µ*"""

df_rus = df_rus.fillna('–û—à–∏–±–æ—á–∫–∞')

df_rus.count()

"""### ***–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è***"""

df_rus[444:600].count() # 444 - 600

df_rus[:100:10]

df_rus[["–±–∞–ª–ª—ã"]]

df_rus[["–±–∞–ª–ª—ã", "—Ü–µ–Ω–∞"]][:10]

"""### ***–ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö***"""

maska = df_rus['—Ü–µ–Ω–∞']>1000
#df_rus[maska]
#maska

maska

df_rus.info()

df_rus.dropna(subset=["—Ü–µ–Ω–∞"], inplace=True)

df_rus["—Ü–µ–Ω–∞"] = df_rus["—Ü–µ–Ω–∞"].astype("int64")

"""#### *–ó–∞–º–µ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π*"""

df_rus['—Ü–µ–Ω–∞'] = df_rus['—Ü–µ–Ω–∞'].replace('–ë–µ—Å–ø–ª–∞—Ç–Ω–æ !', 0)

df_rus["—Ü–µ–Ω–∞"] = df_rus["—Ü–µ–Ω–∞"].astype("int64")
df_rus.info()

df_rus.loc[maska, '–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ']

maska = df_rus['—Ü–µ–Ω–∞'] > 1000
df_rus[maska]

"""### `.loc` // `.iloc`"""

df_rus.loc[:10, ['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', '—Ü–µ–Ω–∞']]

df_rus.iloc[:10, 2:4]

# df_rus.loc[maska]
df_rus.loc[df_rus.—Ä–µ–≥–∏–æ–Ω_2.isna()==True]

"""#### *–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π **Pandas** –∏ —Ü–∏–∫–ª–æ–≤ **Python**...* üïî

‚ùì‚ùì –ó–∞—á–µ–º `.loc`, –µ—Å–ª–∏ –µ—Å—Ç—å `df[]` ‚ùì‚ùì
"""

#@title –î–µ–ª–∞–µ–º 3 000 000 —Å—Ç—Ä–æ–∫
data = pd.read_csv('/content/sample_data/california_housing_test.csv')
df = [data] * 1000 # [] —Å–æ–∑–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π 100 –∫–æ–ø–∏–π –æ–±—ä–µ–∫—Ç–∞ data, –∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç data, –∞ –Ω–µ –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç.

# –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ —Å—Ç—Ä–æ–∫–∞–º
df= pd.concat(df, axis=0)

# –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
df.shape

# –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è housing_median_age
def transform_housing_median_age(data):
    # —Å–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    new_values = []
    # –ø—Ä–æ—Ö–æ–¥ –ø–æ –∫–∞–∂–¥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –≤ —Å—Ç–æ–ª–±—Ü–µ housing_median_age
    for value in data.housing_median_age:
        # –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–∏–º–∏
        if value <= 15:
            new_value = 0
        elif 15 < value <= 30:
            new_value = 1
        else:
            new_value = 2
        # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–ø–∏—Å–æ–∫
        new_values.append(new_value)
    # –∑–∞–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–∞ housing_median_age –Ω–∞ —Å–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    data.housing_median_age = new_values
    # –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
    return data

"""`%%time`, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ —ç—Ç–æ–π —è—á–µ–π–∫–µ. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–∏–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

1. `CPU times`: –≠—Ç–æ—Ç –±–ª–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –≤—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞. –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ 1.57 —Å–µ–∫—É–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ 102 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –≤—Ä–µ–º—è –æ—Ç—Ä–∞–∂–∞–µ—Ç –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∑–∞—Ç—Ä–∞—Ç–∏–ª –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –≤–∞—à–∏–º –∫–æ–¥–æ–º, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –≤–∞—à–∏–º –∫–æ–¥–æ–º.

2. `total`: –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–±—â–µ–µ –≤—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞. –û–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –≤—Ä–µ–º—è.

3. `Wall time`: –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ, —á–µ–º —Å—É–º–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –¥—Ä—É–≥–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏.


"""

# Commented out IPython magic to ensure Python compatibility.
# %%time
# df = transform_housing_median_age(df)

#%%time
df[df.housing_median_age <= 15] = 0
df[(df.housing_median_age > 15)&(df.housing_median_age <= 30)] = 1
df[df.housing_median_age > 30] = 2

# Commented out IPython magic to ensure Python compatibility.
# %%time
# df.loc[df.housing_median_age <= 15, 'housing_median_age'] = 0
# df.loc[(df.housing_median_age > 15)&(df.housing_median_age <= 30), 'housing_median_age'] = 1
# df.loc[df.housing_median_age > 30, 'housing_median_age'] = 2

"""|  –°–ø–æ—Å–æ–± | –í—Ä–µ–º—è |    
|---------|-------|
| Python  | 1680  |
| .loc    | 38.6  |
| Pandas  | 152   |
"""

#@title –ì—Ä–∞—Ñ–∏–∫
import matplotlib.pyplot as plt
import seaborn as sns
sns.set_style('darkgrid')

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
results = [152, 38.6, 1680] # –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
labels = ["Pandas", "Pandas .loc", "Python —Ü–∏–∫–ª—ã"]

plt.figure(figsize=(12,2)) # –ò–∑–º–µ–Ω–∏–º —Ä–∞–∑–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π
# –°–æ–∑–¥–∞–Ω–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.barh(labels, results, color=["g", "b", "m"]) # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é barh –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
plt.xlabel("–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–º—Å)") # –ü–µ—Ä–µ–Ω–µ—Å–µ–º –ø–æ–¥–ø–∏—Å—å –Ω–∞ –æ—Å—å X
plt.ylabel("–°–ø–æ—Å–æ–± –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞") # –ü–µ—Ä–µ–Ω–µ—Å–µ–º –ø–æ–¥–ø–∏—Å—å –Ω–∞ –æ—Å—å Y
plt.title("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –≤ Python")

# –ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫
plt.show()

df_rus.loc[maska]
df_rus.loc[df_rus.—Ü–µ–Ω–∞ > 1000, ['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', '–±–∞–ª–ª—ã', '—Ü–µ–Ω–∞']]

df_rus.loc[df_rus.–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ=='–ü–æ—Ä—Ç–≤–µ–π–Ω', '–±–∞–ª–ª—ã'] = 100
df_rus.loc[df_rus.—Ü–µ–Ω–∞ > 1000, ['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', '–±–∞–ª–ª—ã', '—Ü–µ–Ω–∞']]

df_rus.loc[((df_rus.–±–∞–ª–ª—ã == 100) & (df_rus.—Å—Ç—Ä–∞–Ω–∞ =='France')), ['–±–∞–ª–ª—ã','—Å—Ç—Ä–∞–Ω–∞', '—Ü–µ–Ω–∞']]

"""### –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–¢–µ–ø–µ—Ä—å –∏–∑—É—á–∏—Ç–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞:

–ú–µ—Ç–æ–¥ `.describe()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏ —á–∏—Å–ª–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤.  –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç::

- **count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **mean** - —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —Å—Ç–æ–ª–±—Ü—É
- **std** - —Å—Ä–µ–¥–Ω–µ–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- **min** - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- **–ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏** - —Ç—É—Ç –±—É–¥–µ—Ç –ª–µ–≥—á–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —à–∫–∞–ª—É –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤—Å–µ —Ü–µ–Ω—ã –≤–∏–Ω –∏–∑ —Ç–∞–±–ª–∏—Ü—ã. –û–±–æ–∑–Ω–∞—á–∏–º –Ω–∞ —ç—Ç–æ–π —à–∫–∞–ª–µ 25-—é –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å, 50-—é –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å –∏ 75-—é –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å:


–ù–∞ —ç—Ç–æ–π —à–∫–∞–ª–µ –º–æ–∂–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ü–µ–Ω—ã. 25-–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å—é –±—É–¥–µ—Ç 16\$. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ 25% –≤–∏–Ω –¥–µ—à–µ–≤–ª–µ, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 75% –¥–æ—Ä–æ–∂–µ.


75-–∞—è –ø—Ä–æ—Ü—Ü–µ–Ω—Ç–∏–ª—å –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ 40\$. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, 75% –≤–∏–Ω –∏–º–µ—é—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∏–∂–µ 40\$, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 25% - –≤—ã—à–µ.

"""

df_rus.shape

df_rus.iloc[0]

df_rus.describe()

"""–ü–∞—Ä–∞–º–µ—Ç—Ä `include=['O']` –º–µ—Ç–æ–¥–∞ `.describe()` –≤—ã–≤–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

- **count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **unique** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **top** - —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
- **freq** - —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
"""

df_rus.describe(include=['O'])

"""–ü–∞—Ä–∞–º–µ—Ç—Ä `include=['O']` –º–µ—Ç–æ–¥–∞ `.describe()` –≤—ã–≤–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

- **count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **unique** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **top** - —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
- **freq** - —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
"""

df_rus.describe(include=['O'])

"""### ***–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è***"""

df_rus['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].unique()

df_rus["—Å—Ç—Ä–∞–Ω–∞"].unique()



df_rus['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'].nunique()